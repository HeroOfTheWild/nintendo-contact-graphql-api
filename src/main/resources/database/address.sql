CREATE SCHEMA IF NOT EXISTS NINTENDO;

-- Address Details
CREATE TABLE "NINTENDO"."ADDRESS" (
    ADDRESS_ID varchar(36) PRIMARY KEY NOT NULL, 
    NINTENDO_ID varchar(7) NOT NULL,
    ADDRESS_PURPOSE_DC varchar(15) NOT NULL,
    COUNTRY_CD char(3) NOT NULL,
    STATE_PROVINCE_NM varchar(100),
    CITY_NM varchar(100),
    STREET_ADDRESS_LINE_TXT varchar(255) NOT NULL,
    REGION_CD varchar(30),
    POSTAL_CD varchar(10),
    START_DT date NOT NULL,
    END_DT date,
    MODIFIED timestamp NOT NULL
);

CREATE UNIQUE INDEX XPK_ADDRESS ON "NINTENDO"."ADDRESS"(ADDRESS_ID);
CREATE INDEX ADDRESS_IDX1 ON "NINTENDO"."ADDRESS"(NINTENDO_ID);

INSERT INTO NINTENDO.ADDRESS 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-11a8-4d5b-beda-c831ba120f71', 'nin0001', 'BOTH', 'USA', 'Texas', 'San Antonio', '1985 Nintendo Avenue Apt 1964', NULL, '78240', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-12a8-4d5b-beda-c831ba120f71', 'nin0002', 'RESIDENTIAL', 'USA', 'Texas', 'San Antonio', '1985 Nintendo Avenue Apt 2002', NULL, '78240', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-13a8-4d5b-beda-c831ba120f71', 'nin0002', 'MAILING', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-14a8-4d5b-beda-c831ba120f71', 'nin0003', 'BOTH', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-14a8-0004-beda-c831ba120f71', 'nin0004', 'BOTH', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-14a8-0005-beda-c831ba120f71', 'nin0005', 'PRIMARY', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-07-05 23:54:00');


-- Address History Details
CREATE TABLE "NINTENDO"."ADDRESS_HST" (
    ADDRESS_ID varchar(36) NOT NULL, 
    NINTENDO_ID varchar(7) NOT NULL,
    ADDRESS_PURPOSE_DC varchar(15) NOT NULL,
    COUNTRY_CD char(3) NOT NULL,
    STATE_PROVINCE_NM varchar(100),
    CITY_NM varchar(100),
    STREET_ADDRESS_LINE_TXT varchar(255) NOT NULL,
    REGION_CD varchar(30),
    POSTAL_CD varchar(10),
    START_DT date NOT NULL,
    END_DT date,
    MODIFIED timestamp NOT NULL,
    CONSTRAINT XPK_ADDRESS_HST PRIMARY KEY (ADDRESS_ID, MODIFIED)
);

CREATE UNIQUE INDEX XPK_ADDRESS_HST ON "NINTENDO"."ADDRESS"(ADDRESS_ID, MODIFIED);
CREATE INDEX ADDRESS_HST_IDX1 ON "NINTENDO"."ADDRESS"(NINTENDO_ID);


INSERT INTO NINTENDO.ADDRESS_HST
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-11a8-4d5b-beda-c831ba120f71', 'nin0001', 'BOTH', 'USA', 'Texas', 'San Antonio', '1985 Nintendo Avenue Apt 1964', NULL, '78240', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS_HST 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-12a8-4d5b-beda-c831ba120f71', 'nin0002', 'RESIDENTIAL', 'USA', 'Texas', 'San Antonio', '1985 Nintendo Avenue Apt 2002', NULL, '78240', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS_HST 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-13a8-4d5b-beda-c831ba120f71', 'nin0002', 'MAILING', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-07-05 23:50:00');

INSERT INTO NINTENDO.ADDRESS_HST 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-13a8-4d5b-beda-c831ba120f71', 'nin0002', 'MAILING', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-06-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS_HST 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-13a8-4d5b-beda-c831ba120f71', 'nin0002', 'MAILING', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-05-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS_HST 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-14a8-4d5b-beda-c831ba120f71', 'nin0003', 'MAILING', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-07-05 23:54:00');

INSERT INTO NINTENDO.ADDRESS_HST 
(ADDRESS_ID, NINTENDO_ID, ADDRESS_PURPOSE_DC, COUNTRY_CD, STATE_PROVINCE_NM, CITY_NM, STREET_ADDRESS_LINE_TXT, REGION_CD, POSTAL_CD, START_DT, END_DT, MODIFIED)
VALUES ('n1nt3nd0-14a8-0004-beda-c831ba120f71', 'nin0004', 'MAILING', 'USA', 'Texas', 'San Antonio', 'PO Box 1964', NULL, '78210', '2022-07-05', NULL, '2022-07-05 23:54:00');